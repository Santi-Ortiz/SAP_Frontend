<div class="rentar-container" *ngIf="propiedadSeleccionada">

  <!-- InformaciÃ³n de la propiedad seleccionada -->
  <div class="propiedad-seleccionada">
    <h1>ğŸ  Solicitud de Alquiler</h1>
    
    <div class="propiedad-resumen">
      <div class="propiedad-imagen">
        <img [src]="propiedadSeleccionada.fotoPrincipal" 
             [alt]="propiedadSeleccionada.direccion">
        <span class="tipo-badge" [class]="propiedadSeleccionada.tipo">
          {{propiedadSeleccionada.tipo}}
        </span>
      </div>
      
      <div class="propiedad-datos">
        <h2>{{propiedadSeleccionada.direccion}}</h2>
        <p class="ubicacion">ğŸ“ {{propiedadSeleccionada.ubicacion}}</p>
        <div class="caracteristicas-rapidas">
          <span>ğŸ›ï¸ {{propiedadSeleccionada.numeroCuartos}} cuartos</span>
          <span class="precio">{{formatearPrecio(propiedadSeleccionada.renta)}}/mes</span>
        </div>
        <p class="propietario">ğŸ‘¤ Propietario: {{propiedadSeleccionada.nombreDueno}}</p>
      </div>
    </div>
  </div>

  <!-- Formulario de datos del cliente -->
  <div class="formulario-section" *ngIf="mostrarFormulario && !procesando">
    <h2>ğŸ“‹ Datos del Solicitante</h2>
    <p class="instrucciones">
      Complete la siguiente informaciÃ³n para procesar su solicitud de alquiler.
      Todos los campos son obligatorios.
    </p>

    <form class="formulario-cliente" (ngSubmit)="enviarSolicitud()">
      
      <!-- Nombre completo -->
      <div class="campo-grupo">
        <label for="nombre">Nombre Completo *</label>
        <input 
          type="text" 
          id="nombre" 
          [(ngModel)]="cliente.nombre" 
          name="nombre"
          placeholder="Ingrese su nombre completo"
          required>
      </div>

      <!-- Correo electrÃ³nico -->
      <div class="campo-grupo">
        <label for="correo">Correo ElectrÃ³nico *</label>
        <input 
          type="email" 
          id="correo" 
          [(ngModel)]="cliente.correoElectronico" 
          name="correo"
          placeholder="ejemplo@correo.com"
          required>
      </div>

      <!-- Tipo de identificaciÃ³n -->
      <div class="campo-grupo">
        <label for="tipoId">Tipo de IdentificaciÃ³n *</label>
        <select 
          id="tipoId" 
          [(ngModel)]="cliente.tipoIdentificacion" 
          name="tipoId"
          required>
          <option value="">Seleccione un tipo</option>
          <option value="CC">CÃ©dula de CiudadanÃ­a</option>
          <option value="CE">CÃ©dula de ExtranjerÃ­a</option>
          <option value="PA">Pasaporte</option>
          <option value="TI">Tarjeta de Identidad</option>
          <option value="NIT">NIT</option>
        </select>
      </div>

      <!-- NÃºmero de identificaciÃ³n -->
      <div class="campo-grupo">
        <label for="numeroId">NÃºmero de IdentificaciÃ³n *</label>
        <input 
          type="text" 
          id="numeroId" 
          [(ngModel)]="cliente.numeroIdentificacion" 
          name="numeroId"
          placeholder="Ingrese su nÃºmero de identificaciÃ³n"
          required>
      </div>

      <!-- Botones de acciÃ³n -->
      <div class="botones-accion">
        <button type="button" class="btn-cancelar" (click)="volverABuscar()">
          â† Volver a Buscar
        </button>
        <button type="submit" class="btn-enviar" [disabled]="!validarFormulario()">
          Enviar Solicitud
        </button>
      </div>

    </form>
  </div>

  <!-- Pantalla de procesamiento -->
  <div class="procesando-section" *ngIf="procesando">
    <div class="loader-container">
      <div class="loader"></div>
      <h2>â³ Procesando su solicitud...</h2>
      <p>Por favor espere mientras procesamos su informaciÃ³n.</p>
    </div>
  </div>

  <!-- Mensaje de confirmaciÃ³n -->
  <div class="confirmacion-section" *ngIf="solicitudEnviada && !procesando">
    <div class="mensaje-exito">
      <div class="icono-exito">âœ…</div>
      <h2>Â¡Solicitud Enviada Exitosamente!</h2>
      <p class="mensaje-principal">
        Su solicitud de alquiler para la propiedad <strong>{{propiedadSeleccionada.direccion}}</strong> 
        ha sido recibida y estÃ¡ siendo procesada.
      </p>
      
      <div class="info-procesamiento">
        <h3>Proceso de ValidaciÃ³n</h3>
        <p>
          Su solicitud estÃ¡ siendo <strong>procesada y validada por la instituciÃ³n financiera</strong>
        </p>
        
        <div class="pasos-siguientes">
          <h4>ğŸ“‹ PrÃ³ximos pasos:</h4>
          <ul>
            <li>RecibirÃ¡ un correo de confirmaciÃ³n en: <strong>{{cliente.correoElectronico}}</strong></li>
            <li>La instituciÃ³n financiera validarÃ¡ su informaciÃ³n</li>
            <li>Se comunicarÃ¡n con usted para coordinar la firma del contrato</li>
            <li>El propietario serÃ¡ notificado de su interÃ©s</li>
          </ul>
        </div>

        <div class="datos-referencia">
          <h4>ğŸ“„ Datos de referencia:</h4>
          <p><strong>Solicitante:</strong> {{cliente.nombre}}</p>
          <p><strong>IdentificaciÃ³n:</strong> {{cliente.tipoIdentificacion}} {{cliente.numeroIdentificacion}}</p>
          <p><strong>Fecha de solicitud:</strong> {{fechaSolicitud}}</p>
          <p><strong>NÃºmero de referencia:</strong> #{{numeroReferencia}}</p>
        </div>
      </div>

      <div class="botones-finales">
        <button class="btn-nueva-busqueda" (click)="volverABuscar()">
          ğŸ” Buscar Otras Propiedades
        </button>
      </div>
    </div>
  </div>

</div>

<!-- Mensaje de error si no se encuentra la propiedad -->
<div class="error-container" *ngIf="!propiedadSeleccionada">
  <h2>âŒ Propiedad no encontrada</h2>
  <p>Lo sentimos, no pudimos encontrar la propiedad solicitada.</p>
  <button class="btn-volver" (click)="volverABuscar()">
    â† Volver a Buscar Propiedades
  </button>
</div>